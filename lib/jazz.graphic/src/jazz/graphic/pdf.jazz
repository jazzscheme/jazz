(module jazz.graphic.pdf jazz


(import (jazz.graphic)
        (jazz.platform.cairo)
        (jazz.ui))


(definition public (document->pdf filename view)
  (let* ((size (get-size~ view))
         (surface (new Pdf-Surface #f size filename)))
    (set-clipper~ surface (new Rect 0 0 10000 10000))
    (let ((job (new Print-Job surface view (get-page-setup-for~ view 'printer) 60)))
      (print-job~ job))
    (destroy~ surface)))
    


(class Pdf-Surface extends Surface
  
  
  (slot size getter generate)
  
  
  (method override (initialize _ size filename)
    (let ((surface (cairo_pdf_surface_create filename (exact->inexact (get-width~ size)) (exact->inexact (get-height~ size)))))
      (nextmethod surface)
      (set! size~self size)))))
